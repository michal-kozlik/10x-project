---
import AuthLayout from "@/layouts/AuthLayout.astro";
import LoginForm from "@/components/auth/LoginForm";

// Get next page from query params
const next = Astro.url.searchParams.get("next");

// Session check is now handled by middleware, but we double check
const { session } = Astro.locals;
if (session?.user) {
  return Astro.redirect(next ?? "/app", 302); // 302 for temporary redirect
}
---

<AuthLayout
  title="Witaj ponownie"
  subtitle={next ? `Po zalogowaniu wrÃ³cisz do ${next}` : undefined}
>
  <LoginForm 
    nextPath={next}
    client:load
  />
</AuthLayout>